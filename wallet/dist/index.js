module.exports=function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=26)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8);e.ExtractSecretData=r.ExtractSecretData;var o=n(9);e.ExtractSecretParams=o.ExtractSecretParams;var i=n(10);e.InitiateData=i.InitiateData;var a=n(11);e.InitiateParams=a.InitiateParams;var c=n(12);e.ParticipateData=c.ParticipateData;var u=n(13);e.ParticipateParams=u.ParticipateParams;var s=n(14);e.RedeemData=s.RedeemData;var f=n(4);e.RedeemParams=f.RedeemParams;var p=n(15);e.RefundData=p.RefundData;var l=n(5);e.RefundParams=l.RefundParams},function(t,e){t.exports=require("bitcore")},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,o=n(30),i=n(31);!function(t){t[t.Ripemd160=0]="Ripemd160",t[t.Hash160=1]="Hash160"}(r=e.AlgoTypes||(e.AlgoTypes={}));var a=function(){function t(t,e){this.secret=t,this.secretHash=e}return t}();e.SecretResult=a;var c=function(){function t(){}return t.prototype.hash=function(t){return(new o).update(t).digest("hex")},t.prototype.buffer=function(t){return(new o).update(t).digest()},t}();e.Ripemd160=c;var u=function(){function t(){}return t.prototype.hash=function(t){var e=i.createHash("sha256").update(t).digest();return(new o).update(e).digest("hex")},t.prototype.buffer=function(t){var e=i.createHash("sha256").update(t).digest();return(new o).update(e).digest()},t}();e.Hash160=u;var s=function(){function t(){}return t.generateSecret=function(t){void 0===t&&(t=r.Ripemd160);var e;t===r.Ripemd160?e=new c:t===r.Hash160&&(e=new u);var n=i.randomBytes(32),o=n.toString("hex"),s=e.hash(n);return new a(o,s)},t}();e.SecretGenerator=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(32);e.BtcExtractSecretData=r.BtcExtractSecretData;var o=n(33);e.BtcExtractSecretParams=o.BtcExtractSecretParams;var i=n(16);e.BtcInitiateData=i.BtcInitiateData;var a=n(34);e.BtcInitiateParams=a.BtcInitiateParams;var c=n(35);e.BtcParticipateData=c.BtcParticipateData;var u=n(36);e.BtcParticipateParams=u.BtcParticipateParams;var s=n(37);e.BtcRedeemData=s.BtcRedeemData;var f=n(38);e.BtcRedeemParams=f.BtcRedeemParams;var p=n(17);e.BtcRefundData=p.BtcRefundData;var l=n(39);e.BtcRefundParams=l.BtcRefundParams;var d=n(40);e.BtcAtomicSwapData=d.BtcAtomicSwapData},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t}();e.RedeemParams=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t}();e.RefundParams=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(27);e.BtcWallet=r.BtcWallet;var o=n(45);e.FreshBitcoinWallet=o.FreshBitcoinWallet;var i=n(46);e.RegenerateBitcoinWallet=i.RegenerateBitcoinWallet},function(t,e){t.exports=require("axios")},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t}();e.ExtractSecretData=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t}();e.ExtractSecretParams=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){this.secret=t,this.secretHash=e}return Object.defineProperty(t.prototype,"participateData",{get:function(){return this.secretHash},enumerable:!0,configurable:!0}),t}();e.InitiateData=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t}();e.InitiateParams=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t}();e.ParticipateData=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t}();e.ParticipateParams=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t}();e.RedeemData=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t}();e.RefundData=r},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=function(t){function e(e,n,r,o,i,a,c,u){var s=t.call(this,c,u)||this;return s.fee=e,s.contract=n,s.contractHex=r,s.contractTx=o,s.contractTxHex=i,s.rawTx=a,s}return r(e,t),e}(o.InitiateData);e.BtcInitiateData=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=function(t){function e(e,n){var r=t.call(this)||this;return r.refundFee=e,r.refundTx=n,r}return r(e,t),e}(o.RefundData);e.BtcRefundData=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(3),i=r.Script,a=r.Opcode,c=r.Transaction,u=r.PrivateKey,s=function(){function t(t,e){this.configuration=e}return t.extractAtomicSwapContract=function(t){var e=new i(t),n=e.toString().split(" "),r=n.filter(function(t){return-1===t.indexOf("0x")});if(new a(r[0]).toString()!==new a(a.OP_IF).toString()||new a(r[1]).toString()!==new a(a.OP_RIPEMD160).toString()||20!==parseInt(r[2])||new a(r[3]).toString()!==new a(a.OP_EQUALVERIFY).toString()||new a(r[4]).toString()!==new a(a.OP_DUP).toString()||new a(r[5]).toString()!==new a(a.OP_HASH160).toString()||20!==parseInt(r[6])||new a(r[7]).toString()!==new a(a.OP_ELSE).toString()||!parseInt(r[8])||new a(r[9]).toString()!==new a(a.OP_CHECKLOCKTIMEVERIFY).toString()||new a(r[10]).toString()!==new a(a.OP_DROP).toString()||new a(r[11]).toString()!==new a(a.OP_DUP).toString()||new a(r[12]).toString()!==new a(a.OP_HASH160).toString()||20!==parseInt(r[13])||new a(r[14]).toString()!==new a(a.OP_ENDIF).toString()||new a(r[15]).toString()!==new a(a.OP_EQUALVERIFY).toString()||new a(r[16]).toString()!==new a(a.OP_CHECKSIG).toString())throw new Error("contract is not an atomic swap script!");var c=n.filter(function(t){return-1!==t.indexOf("0x")}),u=c[0],s=c[1],f=c[2].replace("0x",""),p=c[3];return new o.BtcAtomicSwapData(u,s,f,p)},t.atomicSwapContract=function(t,e,n,r){var o=new i;return o.add(a.OP_IF),o.add(a.OP_RIPEMD160),o.add(new Buffer(r,"hex")),o.add(a.OP_EQUALVERIFY),o.add(a.OP_DUP),o.add(a.OP_HASH160),o.add(new Buffer(e,"hex")),o.add(a.OP_ELSE),o.add(new Buffer(function(t){return t<0&&(t=4294967295+t+1),t.toString(16).toUpperCase()}(function(t){var e=new ArrayBuffer(4);return new DataView(e).setUint32(0,t),Array.from(new Uint32Array(e))}(n)[0]),"hex")),o.add("OP_CHECKLOCKTIMEVERIFY"),o.add(a.OP_DROP),o.add(a.OP_DUP),o.add(a.OP_HASH160),o.add(new Buffer(t,"hex")),o.add(a.OP_ENDIF),o.add(a.OP_EQUALVERIFY),o.add(a.OP_CHECKSIG),o},t.redeemP2SHContract=function(t,e,n,r){var o=new i;return o.add(e),o.add(new Buffer(n,"hex")),o.add(new Buffer(r,"hex")),o.add(a.OP_1),o.add(new Buffer(t,"hex")),o},t.refundP2SHContract=function(t,e,n,r){var o=new i;return o.add(new Buffer(e)),o.add(new Buffer(n,"hex")),o.add(a.OP_0),o.add(new Buffer(t,"hex")),o},t.createSig=function(t,e,n,r,o){var i=o,a=new u(i);return{sig:c.Sighash.sign(t,a,1,e,n),pubKey:a.toPublicKey()}},t}();e.BtcContractBuilder=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),o=n(1),i=o.encoding.Base58Check,a=o.Address,c=function(){function t(){}return t.getUnixTimeFor2Days=function(){return t.getCurrentUnixTime()},t.flatMap=function(t){return t.reduce(function(t,e){return t.concat(e)},[])},t.NewAddressPubKeyHash=function(t,e){var n;n="testnet"===e?Buffer.from([111]):Buffer.from([0]);var r=Buffer.from(t,"hex"),o=Buffer.concat([n,r],21),c=i.encode(o);return a.fromString(c)},t.NewAddressScriptHash=function(t,e){var n;n="testnet"===e?Buffer.from([196]):Buffer.from([5]);var o=new r.Hash160,c=Buffer.from(t,"hex"),u=o.buffer(c),s=Buffer.concat([n,u],21),f=i.encode(s);return a.fromString(f)},t.VarIntSerializeSize=function(t){return t<253?1:t<=65535?3:t<=4294967295?5:9},t.InputSize=function(e){return 36+t.VarIntSerializeSize(e)+e+4},t.SumOutputSerializeSizes=function(t){for(var e=0,n=0,r=t;n<r.length;n++){e+=r[n].toBufferWriter().toBuffer().length}return e},t.EstimateRedeemSerializeSize=function(e,n){var r=e.toBuffer().length;return 12+t.VarIntSerializeSize(1)+t.VarIntSerializeSize(n.length)+t.InputSize(t.redeemAtomicSwapSigScriptSize+r)+t.SumOutputSerializeSizes(n)},t.EstimateRefundSerializeSize=function(e,n){var r=e.toBuffer().length;return 12+t.VarIntSerializeSize(1)+t.VarIntSerializeSize(n.length)+t.InputSize(t.refundAtomicSwapSigScriptSize+r)+t.SumOutputSerializeSizes(n)},t.FeeForSerializeSize=function(t,e){return t*e/1024},t.getCurrentUnixTime=function(t){void 0===t&&(t=0);var e=new Date;return e.setDate(e.getDate()+t),parseInt((e.getTime()/1e3).toFixed(0),10)},t.redeemAtomicSwapSigScriptSize=142,t.refundAtomicSwapSigScriptSize=109,t}();e.Util=c},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(51)),r(n(55))},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(8),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(o.ExtractSecretData);e.EthExtractSecretData=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(10),i=function(t){function e(e,n,r,o,i,a,c,u,s,f,p,l,d){var h=t.call(this,e,n)||this;return h.secret=e,h.secretHash=n,h.blockHash=r,h.blockNumber=o,h.contractAddress=i,h.cumulativeGasUsed=a,h.from=c,h.gasUsed=u,h.logsBloom=s,h.status=f,h.to=p,h.transactionHash=l,h.transactionIndex=d,h}return r(e,t),e}(o.InitiateData);e.EthInitiateData=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(12),i=function(t){function e(e,n,r,o,i,a,c,u,s,f,p){var l=t.call(this)||this;return l.blockHash=e,l.blockNumber=n,l.contractAddress=r,l.cumulativeGasUsed=o,l.from=i,l.gasUsed=a,l.logsBloom=c,l.status=u,l.to=s,l.transactionHash=f,l.transactionIndex=p,l}return r(e,t),e}(o.ParticipateData);e.EthParticipateData=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(14),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(o.RedeemData);e.EthRedeemData=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(15),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(o.RefundData);e.EthRefundData=i},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(6)),r(n(47)),r(n(20)),r(n(61)),r(n(0)),r(n(66)),r(n(3))},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function c(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,c)}u((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(t){n=[6,t],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,c,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return c={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c};Object.defineProperty(e,"__esModule",{value:!0});var a=n(7),c=n(1),u=n(28),s=n(29),f=c.HDPrivateKey,p=c.PrivateKey,l=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.btcConfiguration=e,r.btcRpcConfiguration=n,r}return r(e,t),Object.defineProperty(e.prototype,"hdPrivateKey",{get:function(){return this.hierarchicalPrivateKey},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"WIF",{get:function(){return this.hierarchicalPrivateKey.privateKey.toWIF()},enumerable:!0,configurable:!0}),e.prototype.getbalance=function(t){return o(this,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return[4,a.default.get("https://chain.so/api/v2/get_address_balance/BTCTEST/"+t).then(function(t){return t.data.data.confirmed_balance})];case 1:return[2,e.sent()]}})})},e.prototype.recover=function(t){this.hierarchicalPrivateKey=new f(t.code)},e.prototype.create=function(t){if(!u.isValid(t.code))throw Error("Not valid mnemonic code");this.code=new u(t.code),this.generateHDPrivateKey(t.password)},e.prototype.generateAddressFromWif=function(t){return t||(t=this.WIF),new p(t).toPublicKey().toAddress(this.btcConfiguration.network).toString()},e.prototype.generateHDPrivateKey=function(t){console.log(t),this.hierarchicalPrivateKey=this.code.toHDPrivateKey(t,this.btcRpcConfiguration.network)},e}(s.BtcAtomicSwap);e.BtcWallet=l},function(t,e){t.exports=require("bitcore-mnemonic")},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function c(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,c)}u((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(t){n=[6,t],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,c,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return c={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c};Object.defineProperty(e,"__esModule",{value:!0});var a=n(1),c=n(2),u=n(2),s=n(3),f=n(41),p=n(18),l=n(42),d=n(19),h=a.Transaction,y=a.Address,_=a.PrivateKey,b=a.Script,v=a.Buffer,w=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.configuration=n,r}return r(e,t),e.prototype.initiate=function(t){return o(this,void 0,void 0,function(){var e,n,r,o;return i(this,function(i){switch(i.label){case 0:return e=u.SecretGenerator.generateSecret(),n=d.Util.getUnixTimeFor2Days(),console.log("BTC INITIATE, BUILDING CONTRACT..."),[4,this.buildContract(t.address,t.amount,n,e.secretHash,t.privKey)];case 1:return r=i.sent(),console.log("CONTRACT BUILT, PUBLISHING TRANSACTION.."),[4,this.publishTx(r.contractTx.toString())];case 2:return o=i.sent(),console.log("TRANSACTION PUBLISHED, RETURNING.."),[2,new s.BtcInitiateData(r.contractFee,r.contractP2SH.toString(),r.contract.toHex(),r.contractTx.hash,r.contractTx.toString(),o,e.secret,e.secretHash)]}})})},e.prototype.participate=function(t){return o(this,void 0,void 0,function(){var e,n,r;return i(this,function(o){switch(o.label){case 0:return e=d.Util.getUnixTimeFor2Days(),[4,this.buildContract(t.address,t.amount,e,t.secretHash,t.privateKey)];case 1:return n=o.sent(),[4,this.publishTx(n.contractTx.toString())];case 2:return r=o.sent(),[2,new s.BtcParticipateData(n.contractFee,n.contractP2SH.toString(),n.contract.toHex(),n.contractTx.hash,n.contractTx.toString(),r)]}})})},e.prototype.redeem=function(t){return o(this,void 0,void 0,function(){var e,n,r,o,a,c,u,f,l,v,w,m,P,g,O,S,x,A,E,B,j,D,R,T,I,H,C,M;return i(this,function(i){switch(i.label){case 0:if(e=new b(t.contractBin),!(n=p.BtcContractBuilder.extractAtomicSwapContract(t.contractBin)))throw new Error("contract is not an atomic swap script recognized by this tool");for(r=new h(t.contractTx),o=n.recipientHash.replace("0x",""),a=d.Util.NewAddressPubKeyHash(o,"testnet"),c=d.Util.NewAddressScriptHash(t.contractBin,this.configuration.network),u=-1,f=0;f<r.outputs.length;f++)if(l=new b(r.outputs[f].script),v=l.toAddress(this.configuration.network),(w=v.toJSON().hash)===c.toJSON().hash){u=f;break}return-1===u?[2]:(m=_.fromWIF(t.secret),P=m.toPublicKey().toAddress(this.configuration.network),g=new y(P),O=b.buildPublicKeyHashOut(g),S=new h,x=h.Output({script:O,satoshis:0}),S.addOutput(x),[4,this.getFeePerKb()]);case 1:return A=i.sent(),E=d.Util.EstimateRedeemSerializeSize(e,S.outputs),B=1e8*d.Util.FeeForSerializeSize(A,E),j=r.outputs[u].satoshis-B,x=h.Output({script:O,satoshis:j}),S.removeOutput(0),S.addOutput(x),D=h.Input({prevTxId:r.id,outputIndex:u,script:new b(r.outputs[u].script)}),S.uncheckedAddInput(D),R=0,[4,p.BtcContractBuilder.createSig(S,R,e,a,t.secret)];case 2:return T=i.sent(),I=T.sig,H=T.pubKey,C=p.BtcContractBuilder.redeemP2SHContract(e.toHex(),I.toTxFormat(),H.toString(),t.hashedSecret),S.inputs[0].setScript(C),[4,this.publishTx(S.toString())];case 3:return M=i.sent(),[2,new s.BtcRedeemData(S.toString(),M)]}})})},e.prototype.extractSecret=function(t){return o(this,void 0,void 0,function(){var e,n,r;return i(this,function(o){return e=new h(t.redemptionTx),n=d.Util.flatMap(e.toJSON().inputs.map(function(t){return new b(t.scriptString).toString().split(" ").filter(function(t){return-1!==t.indexOf("0x")}).map(function(t){return t.replace("0x","")})})),r=n.find(function(e){return(new c.Ripemd160).buffer(v.from(e,"hex"))===t.hashedSecret}),[2,r]})})},e.prototype.refund=function(t){},e.prototype.auditContract=function(t,e){return o(this,void 0,void 0,function(){var n,r,o,a,c,u,s,l,y,_,v,w,m,P=this;return i(this,function(i){if(n=new b(t),r=n.toScriptHashOut(),o=r.toAddress(),a=o.toJSON().hash,c=new h(e),!(u=c.toJSON().outputs.find(function(t){return new b(t.script).toAddress(P.configuration.network).toJSON().hash===a})))throw new Error("transaction does not contain the secret");return s=p.BtcContractBuilder.extractAtomicSwapContract(t),l=s.recipientHash.replace("0x",""),y=d.Util.NewAddressPubKeyHash(l,this.configuration.network),_=s.refundHash160.replace("0x",""),v=d.Util.NewAddressPubKeyHash(_,this.configuration.network),w=d.Util.NewAddressScriptHash(t,this.configuration.network).toString(),m=u.satoshis/1e8+" BTC",[2,new f.BtcAuditContractData(w,m,y.toString(),v.toString(),s.secretHash.replace("0x",""),new Date(1e3*s.lockTime))]})})},e}(l.BtcTransaction);e.BtcAtomicSwap=w},function(t,e){t.exports=require("ripemd160")},function(t,e){t.exports=require("crypto-browserify")},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(o.ExtractSecretData);e.BtcExtractSecretData=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(o.ExtractSecretParams);e.BtcExtractSecretParams=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=function(t){function e(e,n,r,o,i){var a=t.call(this)||this;return a.refundTime=e,a.privKey=n,a.address=r,a.amount=o,a.extendedParams=i,a}return r(e,t),e}(o.InitiateParams);e.BtcInitiateParams=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(16),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(o.BtcInitiateData);e.BtcParticipateData=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(13),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(o.ParticipateParams);e.BtcParticipateParams=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=function(t){function e(e,n){var r=t.call(this)||this;return r.redeemTx=e,r.rawTx=n,r}return r(e,t),e}(o.RedeemData);e.BtcRedeemData=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(o.RedeemParams);e.BtcRedeemParams=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(5),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(o.RefundParams);e.BtcRefundParams=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,n,r){this.secretHash=t,this.recipientHash=e,this.lockTime=n,this.refundHash160=r}return t}();e.BtcAtomicSwapData=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,n,r,o,i){this.contractSH=t,this.contractValue=e,this.recipientAddress=n,this.refundAddress=r,this.secretHash=o,this.lockTime=i}return t}();e.BtcAuditContractData=r},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function c(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,c)}u((r=r.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(t){n=[6,t],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,c,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return c={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c};Object.defineProperty(e,"__esModule",{value:!0});var i=n(7),a=n(43),c=n(1),u=n(3),s=n(44),f=n(18),p=n(19),l=c.Transaction.UnspentOutput,d=c.PrivateKey,h=c.Transaction,y=c.Address,_=c.Script,b=c.encoding.BufferReader,v=function(){function t(t,e){this.configuration=e,this.rpc=new a(e)}return t.prototype.callRPCProc=function(t,e){return r(this,void 0,void 0,function(){var n;return o(this,function(r){switch(r.label){case 0:return n=this.configuration.protocol+"://"+this.configuration.user+":"+this.configuration.pass+"@"+this.configuration.host+":"+this.configuration.port,[4,i.default.post(n,{rpcuser:this.configuration.user,rpcpassword:this.configuration.pass,method:t,params:e},{auth:{username:this.configuration.user,password:this.configuration.pass}})];case 1:return[2,r.sent()]}})})},t.prototype.buildContract=function(t,e,n,i,a){return r(this,void 0,void 0,function(){var r,c,u,l,b,v,w,m,P,g,O,S,x,A,E,B;return o(this,function(o){switch(o.label){case 0:return r=d.fromWIF(a),c=r.toPublicKey().toAddress(this.configuration.network),u=new y(t),l=f.BtcContractBuilder.atomicSwapContract(c.toJSON().hash,u.toJSON().hash,n,i),b=p.Util.NewAddressScriptHash(l.toHex(),this.configuration.network),v=_.buildScriptHashOut(b),w=new h,m=Math.round(1e8*e),P=h.Output({script:v,satoshis:m}),w.addOutput(P),[4,this.fundTransaction(c,w)];case 1:for(o.sent(),g=w.getSignatures(a),O=0,S=g;O<S.length;O++)x=S[O],w.applySignature(x);return A=w.hash,E=w._getInputAmount()-w._getOutputAmount(),[4,this.buildRefund(l.toHex(),w.toString(),a)];case 2:return B=o.sent(),[2,new s.BtcAtomicSwapContractData(l,b,v,A,w,E,B.refundFee,B.refundTx)]}})})},t.prototype.buildRefund=function(t,e,n){return r(this,void 0,void 0,function(){var r,i,a,c,s,l,d,v,w,m,P,g,O,S,x,A,E,B,j,D,R,T,I,H,C,M,k;return o(this,function(o){switch(o.label){case 0:if(r=new _(t),!(i=f.BtcContractBuilder.extractAtomicSwapContract(t)))throw new Error("contract is not an atomic swap script recognized by this tool");for(a=new h(e),c=i.refundHash160.replace("0x",""),s=p.Util.NewAddressPubKeyHash(c,"testnet"),l=p.Util.NewAddressScriptHash(t,this.configuration.network),d=-1,v=0;v<a.outputs.length;v++)if(w=new _(a.outputs[v].script),m=w.toAddress(this.configuration.network),(P=m.toJSON().hash)===l.toJSON().hash){d=v;break}if(-1===d)throw new Error("transaction does not contain a contract output");return[4,this.getChangeAddress()];case 1:return g=o.sent(),console.log("addr initiation",g),O=new y(g.data.result),console.log("addr initiation"),S=_.buildPublicKeyHashOut(O),console.log("0 initiation"),x=new h,A=new b(i.lockTime).readUInt32LE(),x.lockUntilDate(A),console.log("1 initiation"),E=h.Output({script:S,satoshis:0}),x.addOutput(E),[4,this.getFeePerKb()];case 2:if(B=o.sent(),j=p.Util.EstimateRefundSerializeSize(r,x.outputs),D=p.Util.FeeForSerializeSize(B,j),(R=a.outputs[d].satoshis-D)&&R<0)throw new Error("Transaction amount is too small!");return console.log("2 initiation",R,a.outputs[d].satoshis,D),E=h.Output({script:S,satoshis:Math.round(R)}),x.removeOutput(0),x.addOutput(E),T=h.Input({prevTxId:a.id,outputIndex:d,sequenceNumber:0,script:new _(a.outputs[d].script)}),console.log("3 initiation"),x.uncheckedAddInput(T),I=0,[4,f.BtcContractBuilder.createSig(x,I,r,s,n)];case 3:return H=o.sent(),C=H.sig,M=H.pubKey,console.log("4 initiation"),k=f.BtcContractBuilder.refundP2SHContract(r.toHex(),C.toTxFormat(),M.toString(),""),x.inputs[0].setScript(k),[2,new u.BtcRefundData(D,x)]}})})},t.prototype.publishTx=function(t){return r(this,void 0,void 0,function(){var e=this;return o(this,function(n){return[2,new Promise(function(n,r){e.rpc.sendRawTransaction(t,function(t,e){n(e.result)})})]})})},t.prototype.getRawChangeAddress=function(){return r(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return[4,this.callRPCProc("getrawchangeaddress",[])];case 1:return[2,t.sent()]}})})},t.prototype.fundRawTransaction=function(t,e){return r(this,void 0,void 0,function(){return o(this,function(n){switch(n.label){case 0:return[4,this.callRPCProc("getrawchangeaddress",[t,{feeRate:e}])];case 1:return[2,n.sent()]}})})},t.prototype.estimateFee=function(){return r(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return[4,this.callRPCProc("estimatesmartfee",[6])];case 1:return[2,t.sent()]}})})},t.prototype.getUnspentOutputs=function(t){return r(this,void 0,void 0,function(){var e,n,r;return o(this,function(o){switch(o.label){case 0:return e=1,n="https://chain.so/api/v2/get_tx_unspent/BTCTEST/"+t+"/"+e,[4,i.default.get(n)];case 1:return r=o.sent(),[2,r.data.data.txs]}})})},t.prototype.fundTransaction=function(t,e){return r(this,void 0,void 0,function(){var n,r,i,a,c,u;return o(this,function(o){switch(o.label){case 0:return[4,this.getUnspentOutputs(t.toString())];case 1:for(n=o.sent(),r=0,i=n;r<i.length&&(a=i[r],c=Math.round(1e8*a.value),u=new l({txId:a.txid,outputIndex:a.output_no,address:t,script:a.script_hex,satoshis:c}),e.from(u),!(e._getOutputAmount()<e._getInputAmount()));r++);if(e._getOutputAmount()>e._getInputAmount())throw new Error("insufficent funds");return e.change(t),[2,e]}})})},t.prototype.getChangeAddress=function(){return r(this,void 0,void 0,function(){var t;return o(this,function(e){switch(e.label){case 0:return[4,this.getRawChangeAddress()];case 1:return t=e.sent(),[2,t]}})})},t.prototype.getFeePerKb=function(){return r(this,void 0,void 0,function(){var t;return o(this,function(e){switch(e.label){case 0:return[4,this.callRPCProc("estimatesmartfee",[6])];case 1:return t=e.sent(),t.data.result.errors?[2,this.calculateFee()]:[2,t.data.result.feerate]}})})},t.prototype.calculateFee=function(){return r(this,void 0,void 0,function(){var t,e;return o(this,function(n){switch(n.label){case 0:return[4,this.callRPCProc("estimaterawfee",[6])];case 1:return t=n.sent(),e=t.data.result,0!==e.medium.fail.startrange?[2,e.medium.fail.startrange]:0!==e.long.fail.startrange?[2,e.long.fail.startrange]:[2,e.short.fail.startrange]}})})},t.prototype.getFeeFromBlockCypher=function(){return r(this,void 0,void 0,function(){var t;return o(this,function(e){switch(e.label){case 0:return[4,i.default.get("https://api.blockcypher.com/v1/btc/test3")];case 1:return t=e.sent(),[2,t.data.result.medium_fee_per_kb]}})})},t}();e.BtcTransaction=v},function(t,e){t.exports=require("bitcoind-rpc")},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(17),i=function(t){function e(e,n,r,o,i,a,c,u){var s=t.call(this,c,u)||this;return s.contract=e,s.contractP2SH=n,s.contractP2SHPkScript=r,s.contractTxHash=o,s.contractTx=i,s.contractFee=a,s}return r(e,t),e}(o.BtcRefundData);e.BtcAtomicSwapContractData=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){void 0===e&&(e=""),this.code=t,this.password=e}return t}();e.FreshBitcoinWallet=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){this.code=t,this.password=e}return t}();e.RegenerateBitcoinWallet=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(48))},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(6),i=n(49),a=n(50),c=function(t){function e(){return t.call(this,a.BtcConfiguration,i.BtcRpcConfiguration)||this}return r(e,t),e}(o.BtcWallet);e.BtcWalletTestNet=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BtcRpcConfiguration={protocol:"http",user:"bedrock",pass:"bedrock",host:"34.215.58.192",port:"8013",network:"testnet"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BtcConfiguration={protocol:"https",user:"bedrock",pass:"bedrock",host:"swap.altcoin.io",port:"8014",network:"testnet"}},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function c(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,c)}u((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(t){n=[6,t],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,c,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return c={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c};Object.defineProperty(e,"__esModule",{value:!0});var a=n(52),c=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return r(e,t),e.prototype.login=function(t,e){return this.engine.login(t,e)},e.prototype.create=function(t){return this.engine.createAccount(t)},e.prototype.recover=function(t,e){return this.engine.recoverAccount(t,e)},e.prototype.getbalance=function(t){return o(this,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return[4,this.engine.getBalance(t)];case 1:return[2,e.sent()]}})})},e.prototype.sendAllEther=function(t,e){return this.engine.sendAllEther(t,e)},e}(a.EthAtomicSwap);e.EthWallet=c},function(t,e,n){"use strict";var r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function c(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,c)}u((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(t){n=[6,t],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,c,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return c={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c};Object.defineProperty(e,"__esModule",{value:!0});var a=n(2),c=n(21),u=n(22),s=n(23),f=n(24),p=n(25),l=n(53),d=function(){function t(t,e,n){this.appConfiguration=e,this.engine=new l.EthEngine(t,e,n)}return t.prototype.initiate=function(t){return o(this,void 0,void 0,function(){var e,n,r,o,c;return i(this,function(i){switch(i.label){case 0:return e=a.SecretGenerator.generateSecret(),n=t.refundTime,r=-1===e.secretHash.indexOf("0x")?"0x"+e.secretHash:e.secretHash,o=t.address,c={from:this.appConfiguration.defaultWallet,value:this.engine.toWei(t.amount,"ether")},[4,this.engine.callFunction("initiate",[n,r,o],c).then(function(t){return new u.EthInitiateData(e.secret,e.secretHash,t.blockHash,t.blockNumber,t.contractAddress,t.cumulativeGasUsed,t.from,t.gasUsed,t.logsBloom,t.status,t.to,t.transactionHash,t.transactionIndex)})];case 1:return[2,i.sent()]}})})},t.prototype.participate=function(t){return o(this,void 0,void 0,function(){var e,n,r,o,a;return i(this,function(i){switch(i.label){case 0:return e=t.refundTime,n=t.secretHash,r=t.address,o={from:this.appConfiguration.defaultWallet,value:this.engine.toWei(t.amount,"ether")},console.log("ETH PARTICIPATE PARAMS: ",t),[4,this.engine.callFunction("participate",[e,n,r],o)];case 1:return a=i.sent(),console.log("ETH PARTICIPATE RESPONSE: ",a),[2,new s.EthParticipateData(a.blockHash,a.blockNumber,a.contractAddress,a.cumulativeGasUsed,a.from,a.gasUsed,a.logsBloom,a.status,a.to,a.transactionHash,a.transactionIndex)]}})})},t.prototype.redeem=function(t){return o(this,void 0,void 0,function(){var e,n,o,a;return i(this,function(i){switch(i.label){case 0:return e=t.secret,n=t.hashedSecret,o=t.extendedParams,a=r({from:this.appConfiguration.defaultWallet},o),[4,this.engine.callFunction("redeem",[e,n],a,1).then(function(t){return new f.EthRedeemData})];case 1:return[2,i.sent()]}})})},t.prototype.extractSecret=function(t){return o(this,void 0,void 0,function(){var e,n,o;return i(this,function(i){switch(i.label){case 0:return e=t.hashedSecret,n=t.extendedParams,o=r({from:this.appConfiguration.defaultWallet},n),[4,this.engine.callFunction("swaps",[e],o,2).then(function(t){return new c.EthExtractSecretData})];case 1:return[2,i.sent()]}})})},t.prototype.refund=function(t){return o(this,void 0,void 0,function(){var e,n,o;return i(this,function(i){return e=t.hashedSecret,n=t.extendedParams,o=r({from:this.appConfiguration.defaultWallet},n),[2,this.engine.callFunction("refund",[e],o).then(function(t){return new p.EthRefundData})]})})},t}();e.EthAtomicSwap=d},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function c(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,c)}u((r=r.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(t){n=[6,t],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,c,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return c={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c};Object.defineProperty(e,"__esModule",{value:!0});var i=n(54),a=function(){function t(t,e,n){this.abiConfiguration=t,this.configuration=e,this.bin=n;var r=new i.providers.WebsocketProvider(e.wshost);this.web3=new i(r),this.web3.defaultAccount=e.defaultWallet,this.contract=new this.web3.eth.Contract(t,e.contractAddress)}return t.prototype.createAccount=function(t){var e=this.web3.eth.accounts,n=e.create();return{wallet:n,keystore:n.encrypt(t,{n:256})}},t.prototype.login=function(t,e){var n=this.web3.eth.accounts,r=n.decrypt(t,e);return this.configuration.defaultWallet=r.address,this.web3.eth.accounts.wallet.add(r),this.web3.eth.defaultAccount=r.address,r},t.prototype.getBalance=function(t){var e=this;return this.web3.eth.getBalance(t).bind(this).then(function(t){return e.web3.utils.fromWei(t,"ether")})},t.prototype.sendAllEther=function(t,e){return r(this,void 0,void 0,function(){var n,r,i,a;return o(this,function(o){switch(o.label){case 0:return[4,this.getBalance(this.web3.eth.defaultAccount)];case 1:return n=o.sent(),[4,this.web3.eth.getGasPrice()];case 2:return r=o.sent(),[4,this.web3.eth.estimateGas({from:this.web3.eth.defaultAccount,to:e,amount:n})];case 3:return i=o.sent(),[4,this.web3.eth.signTransaction({from:this.web3.eth.defaultAccount,gasPrice:r,gas:i,gasLimit:2*i,to:e,value:n-i*r*2,data:""},t)];case 4:return a=o.sent(),[2,this.web3.eth.sendSignedTransaction(a.rawTransaction)]}})})},t.prototype.callFunction=function(t,e,n,i){return r(this,void 0,void 0,function(){var r,a;return o(this,function(o){switch(o.label){case 0:return i=void 0===i?0:i,r=new this.web3.eth.Contract(this.abiConfiguration,this.configuration.contractAddress),void 0!==n.gas?[3,2]:[4,this.web3.eth.estimateGas({data:this.bin.code,to:this.abiConfiguration.defaultWallet})];case 1:a=o.sent(),n.gas=a,n.gasLimit=2*a,o.label=2;case 2:return[2,new Promise(function(o,a){try{var c=(u=r.methods)[t].apply(u,e);0===i?c.send(n).on("receipt",function(t){o(t)}).catch(function(t){a(t)}):1===i?c.send(n).on("confirmation",function(t,e){e.confNumber=t,o(e)}).catch(function(t){a(t)}):2===i&&c.call(n,function(t,e){o(e)}).catch(function(t){a(t)})}catch(t){a(t)}var u})]}})})},t.prototype.recoverAccount=function(t,e){return this.web3.eth.accounts.privateKeyToAccount(this.web3.utils.asciiToHex(t)).encrypt(t,e)},t.prototype.toWei=function(t,e){return this.web3.utils.toWei(t,e)},t}();e.EthEngine=a},function(t,e){t.exports=require("web3/src")},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(21);e.EthExtractSecretData=r.EthExtractSecretData;var o=n(56);e.EthExtractSecretParams=o.EthExtractSecretParams;var i=n(22);e.EthInitiateData=i.EthInitiateData;var a=n(57);e.EthInitiateParams=a.EthInitiateParams;var c=n(23);e.EthParticipateData=c.EthParticipateData;var u=n(58);e.EthParticipateParams=u.EthParticipateParams;var s=n(24);e.EthRedeemData=s.EthRedeemData;var f=n(59);e.EthRedeemParams=f.EthRedeemParams;var p=n(25);e.EthRefundData=p.EthRefundData;var l=n(60);e.EthRefundParams=l.EthRefundParams},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(9),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(o.ExtractSecretParams);e.EthExtractSecretParams=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(11),i=function(t){function e(e,n,r){var o=t.call(this)||this;return o.refundTime=e,o.address=n,o.amount=r,o}return r(e,t),e}(o.InitiateParams);e.EthInitiateParams=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=function(t){function e(e,n,r,o,i){var a=t.call(this)||this;return a.refundTime=e,a.secretHash=n,a.address=r,a.amount=o,a.privateKey=i,a}return r(e,t),e}(o.ParticipateParams);e.EthParticipateParams=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(o.RedeemParams);e.EthRedeemParams=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(5),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(o.RefundParams);e.EthRefundParams=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(62);e.EthWalletTestnet=r.EthWalletTestnet},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(63),i=n(64),a=n(65),c=n(20),u=function(t){function e(){return t.call(this,o.AtomicSwapAbi,a.EthConfiguration.hosts[0],i.AtomicSwapBin)||this}return r(e,t),e}(c.EthWallet);e.EthWalletTestnet=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AtomicSwapAbi=[{constant:!1,inputs:[{name:"_refundTime",type:"uint256"},{name:"_hashedSecret",type:"bytes20"},{name:"_initiator",type:"address"}],name:"participate",outputs:[],payable:!0,type:"function"},{constant:!1,inputs:[{name:"_hashedSecret",type:"bytes20"}],name:"refund",outputs:[],payable:!1,type:"function"},{constant:!1,inputs:[{name:"_secret",type:"bytes32"},{name:"_hashedSecret",type:"bytes20"}],name:"redeem",outputs:[],payable:!1,type:"function"},{constant:!1,inputs:[{name:"_refundTime",type:"uint256"},{name:"_hashedSecret",type:"bytes20"},{name:"_participant",type:"address"}],name:"initiate",outputs:[],payable:!0,type:"function"},{constant:!0,inputs:[{name:"",type:"bytes20"}],name:"swaps",outputs:[{name:"initTimestamp",type:"uint256"},{name:"refundTime",type:"uint256"},{name:"hashedSecret",type:"bytes20"},{name:"secret",type:"bytes32"},{name:"initiator",type:"address"},{name:"participant",type:"address"},{name:"value",type:"uint256"},{name:"emptied",type:"bool"},{name:"state",type:"uint8"}],payable:!1,type:"function"},{inputs:[],payable:!1,type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,name:"_refundTime",type:"uint256"}],name:"Refunded",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"_redeemTime",type:"uint256"}],name:"Redeemed",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"_initiator",type:"address"},{indexed:!1,name:"_participator",type:"address"},{indexed:!1,name:"_hashedSecret",type:"bytes20"},{indexed:!1,name:"_value",type:"uint256"}],name:"Participated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"_initTimestamp",type:"uint256"},{indexed:!1,name:"_refundTime",type:"uint256"},{indexed:!1,name:"_hashedSecret",type:"bytes20"},{indexed:!1,name:"_participant",type:"address"},{indexed:!1,name:"_initiator",type:"address"},{indexed:!1,name:"_funds",type:"uint256"}],name:"Initiated",type:"event"}]},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AtomicSwapBin={code:"0x6060604052341561000f57600080fd5b5b5b5b61093a806100216000396000f300606060405263ffffffff7c010000000000000000000000000000000000000000000000000000000060003504166327f10ee081146100695780635a8f9b811461008f5780637ec27ba1146100b1578063eb8ae1ed146100d6578063f325cc91146100fc575b600080fd5b61008d6004356001606060020a031960243516600160a060020a0360443516610193565b005b341561009a57600080fd5b61008d6001606060020a0319600435166102dc565b005b34156100bc57600080fd5b61008d6004356001606060020a0319602435166104ba565b005b61008d6004356001606060020a031960243516600160a060020a0360443516610727565b005b341561010757600080fd5b61011c6001606060020a0319600435166108a2565b604051898152602081018990526001606060020a03198816604082015260608101879052600160a060020a038087166080830152851660a082015260c0810184905282151560e0820152610100810182600281111561017757fe5b60ff168152602001995050505050505050505060405180910390f35b8160005b6001606060020a03198216600090815260208190526040902060070154610100900460ff1660028111156101c757fe5b146101d157600080fd5b6001606060020a03198316600090815260208190526040902060018101859055428155600581018054600160a060020a0333811673ffffffffffffffffffffffffffffffffffffffff199283161790925560048301805492861692821692909217909155346006830155600280830180546c0100000000000000000000000088049316929092179091556007909101805461ff001916610100835b02179055507fd2ae53b489af667edae5247fc948af6bab36cb0ec684fb14cc114c95905f4f1982338534604051600160a060020a0394851681529290931660208301526001606060020a0319166040808301919091526060820192909252608001905180910390a15b5b50505050565b6001606060020a03198116600090815260208190526040902060018101549054829101421161030a57600080fd5b6001606060020a0319811660009081526020819052604090206007015460ff161561033457600080fd5b60025b6001606060020a03198316600090815260208190526040902060070154610100900460ff16600281111561036757fe5b14156103c5576001606060020a03198216600090815260208190526040908190206005810154600690910154600160a060020a039091169181156108fc02919051600060405180830381858888f1935050505015156103c557600080fd5b5b60015b6001606060020a03198316600090815260208190526040902060070154610100900460ff1660028111156103f957fe5b1415610457576001606060020a03198216600090815260208190526040908190206004810154600690910154600160a060020a039091169181156108fc02919051600060405180830381858888f19350505050151561045757600080fd5b5b6001606060020a0319821660009081526020819052604090819020600701805460ff191660011790557f3d2a04f53164bedf9a8a46353305d6b2d2261410406df3b41f99ce6489dc003c9042905190815260200160405180910390a15b5b5050565b80826001606060020a031982166003826000604051602001526040519081526020908101906040518083038160008661646e5a03f115156104fa57600080fd5b5050604051516c01000000000000000000000000026bffffffffffffffffffffffff191614151561052a57600080fd5b6001606060020a0319821660009081526020819052604090206001810154905401421061055657600080fd5b6001606060020a0319821660009081526020819052604090206007015460ff161561058057600080fd5b60025b6001606060020a03198416600090815260208190526040902060070154610100900460ff1660028111156105b357fe5b1415610611576001606060020a03198316600090815260208190526040908190206004810154600690910154600160a060020a039091169181156108fc02919051600060405180830381858888f19350505050151561061157600080fd5b5b60015b6001606060020a03198416600090815260208190526040902060070154610100900460ff16600281111561064557fe5b14156106a3576001606060020a03198316600090815260208190526040908190206005810154600690910154600160a060020a039091169181156108fc02919051600060405180830381858888f1935050505015156106a357600080fd5b5b6001606060020a0319831660009081526020819052604090819020600701805460ff191660011790557f82498456531a1065f689ba348ce20bda781238c424cf36748dd40bc282831e039042905190815260200160405180910390a16001606060020a0319831660009081526020819052604090206003018490555b5b50505050565b8160005b6001606060020a03198216600090815260208190526040902060070154610100900460ff16600281111561075b57fe5b1461076557600080fd5b6001606060020a031983166000908152602081905260409020600180820186905542825560028201805473ffffffffffffffffffffffffffffffffffffffff199081166c010000000000000000000000008804179091556005830180548216600160a060020a0387811691909117909155600484018054909216339091161790556007909101805461ff001916610100835b02179055506001606060020a0319831660009081526020819052604090819020346006820181905590547f8f52c15a8dda5af727677001f0ceb13df57f42198fd5cdde86a06aee80333a4b9290918791879187913391905195865260208601949094526001606060020a0319909216604080860191909152600160a060020a0391821660608601529116608084015260a083019190915260c0909101905180910390a15b5b50505050565b60006020819052908152604090208054600182015460028301546003840154600485015460058601546006870154600790970154959694956c01000000000000000000000000909402949293600160a060020a0392831693919092169160ff80821691610100900416895600a165627a7a7230582054264d7ff3736ef9a141f8a979792a740b1b87bfb3e34086317794d90875482e0029"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EthConfiguration={apihost:"http://34.215.58.192:9984/api/v1/",wshost:"ws://34.215.58.192:9985/api/v1/streams/valid_transactions",appid:"DLiUBJ8NGMh6ojuFjwAqhF4L8D2hUsSH5CCcH1X648Fe",appkey:"GgZtjS6WPDNAePNM43ZdPoJ1Ap61RU3jnsgjHqELxgHX",hosts:[{wshost:"wss://swap.altcoin.io:8550",contractAddress:"0x6d5ae9dd8f1a2582deb1b096915313459f11ba70",defaultWallet:"0xb483f5a8c6ebA74Dc1bcef9D167E6B86Caa4C773"},{wshost:"wss://swap.altcoin.io:8550",contractAddress:"0x6d5ae9dd8f1a2582deb1b096915313459f11ba70",defaultWallet:"0x21Fa313f2144f6E1348d91FbF0C6A3a5EEcC056D"}]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2);e.SecretGenerator=r.SecretGenerator}]);
//# sourceMappingURL=index.js.map